#!/usr/bin/env perl
use 5.016;
use warnings;

my $CSI = "\033[";
sub recolor {
    my $c = shift;
    my $fg = shift;

    my $lookup = {
         0 => [255,255,255],
         1 => [0,0,0],
         2 => [0,0,127],
         3 => [0,147,0],
         4 => [255,0,0],
         5 => [127,0,0],
         6 => [156,0,156],
         7 => [252,127,0],
         8 => [255,255,0],
         9 => [0,252,0],
        10 => [0,147,147],
        11 => [0,255,255],
        12 => [0,0,252],
        13 => [255,0,255],
        14 => [127,127,127],
        15 => [210,210,210],
    };

    my ($r, $g, $b) = @{ $lookup->{$c + 0} };


    return $CSI . ($fg ? 38 : 48) . ";2;$r;$g;${b}m";
}

for (<>) {
    s/\x03(1[0-5]|0?[0-9])/recolor($1,1)/eg;
    s/\x02//g;
    print;
}
